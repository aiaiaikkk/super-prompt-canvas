# Kontext Super Prompt

**ComfyUIå›¾åƒç¼–è¾‘ä¸æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå·¥å…·é›†** - ä¸“ä¸šçš„å¯è§†åŒ–ç¼–è¾‘ä¸AIå¢å¼ºæç¤ºè¯ç”Ÿæˆ

![Installation](images/instruction.png)

## ğŸ¯ ä¸»è¦èŠ‚ç‚¹

### ğŸ¨ LRPG Canvas  
å¯è§†åŒ–ç”»å¸ƒæ ‡æ³¨å·¥å…·ï¼Œæä¾›ä¸“ä¸šçš„å›¾å±‚ç®¡ç†å’Œç»˜åˆ¶åŠŸèƒ½
- åŸºäºFabric.jsçš„äº¤äº’å¼ç”»å¸ƒç•Œé¢
- æ”¯æŒå¤šç§ç»˜åˆ¶å·¥å…·å’Œå›¾å±‚æ“ä½œ
- è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–å›¾å±‚æ•°æ®ä¾›ä¸‹æ¸¸èŠ‚ç‚¹ä½¿ç”¨
- å®æ—¶ç”»å¸ƒçŠ¶æ€åŒæ­¥

![LRPG Canvas](images/LRPG_Canvas.png)

### ğŸ¯ Kontext Super Prompt
æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå™¨ï¼Œå°†å›¾å±‚ä¿¡æ¯è½¬æ¢ä¸ºç»“æ„åŒ–ç¼–è¾‘æŒ‡ä»¤
- **å››ç§ç¼–è¾‘æ¨¡å¼**: å±€éƒ¨ç¼–è¾‘ã€å…¨å±€ç¼–è¾‘ã€æ–‡å­—ç¼–è¾‘ã€ä¸“ä¸šæ“ä½œ
- **40+æ“ä½œæ¨¡æ¿**: æ¶µç›–é¢œè‰²å˜æ¢ã€é£æ ¼é‡æ„ã€æ™ºèƒ½æ›¿æ¢ç­‰
- **çº¦æŸå’Œä¿®é¥°**: è‡ªåŠ¨ç”Ÿæˆè´¨é‡æ§åˆ¶å’Œæ•ˆæœå¢å¼ºæç¤ºè¯
- **ç¡®å®šæ€§è¾“å‡º**: ç›¸åŒè¾“å…¥ä¿è¯ç›¸åŒç»“æœ

![Kontext Super Prompt](images/KontextSuperPrompt.png)

## ğŸ¤– AIå¢å¼ºèŠ‚ç‚¹

### API Flux Kontext Enhancer
é€šè¿‡APIè°ƒç”¨å¤šç§å¤§æ¨¡å‹å¢å¼ºæç¤ºè¯ç”Ÿæˆ
- **æ”¯æŒå¹³å°**: OpenAIã€DeepSeekã€åƒé—®ã€Geminiã€SiliconFlow
- **æˆæœ¬æ§åˆ¶**: å®æ—¶æ˜¾ç¤ºTokenæ¶ˆè€—å’Œè´¹ç”¨ä¼°ç®—
- **æ™ºèƒ½åˆ†æ**: è‡ªåŠ¨ç†è§£ç¼–è¾‘æ„å›¾å¹¶ä¼˜åŒ–æŒ‡ä»¤

![API](images/api.png)

### Ollama Flux Kontext Enhancer  
æœ¬åœ°è¿è¡Œçš„å¤§æ¨¡å‹å¢å¼ºå™¨
- **éšç§ä¿æŠ¤**: å®Œå…¨æœ¬åœ°å¤„ç†ï¼Œæ— éœ€ç½‘ç»œè¿æ¥
- **æ¨¡å‹ç®¡ç†**: æ”¯æŒå¤šç§å¼€æºLLMæ¨¡å‹
- **å‚æ•°å¯è°ƒ**: æ¸©åº¦ã€æœ€å¤§Tokenç­‰å‚æ•°è‡ªå®šä¹‰

![Ollama](images/ollama.png)

### TextGenWebUI Flux Kontext Enhancer
ä¸Text Generation WebUIçš„é›†æˆæ–¹æ¡ˆ
- **æ— ç¼å¯¹æ¥**: ç›´æ¥è°ƒç”¨WebUIæ¥å£
- **æ‰¹é‡å¤„ç†**: æ”¯æŒå¤šä»»åŠ¡å¹¶è¡Œå¤„ç†
- **çŠ¶æ€ç›‘æ§**: å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦

![TextGenWebUI](images/textgen_webui.png)

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€å·¥ä½œæµ
1. æ·»åŠ `ğŸ¨ LRPG Canvas`èŠ‚ç‚¹ï¼Œè¿æ¥å›¾åƒè¾“å…¥
2. åœ¨ç”»å¸ƒä¸­åˆ›å»ºå›¾å±‚å’Œæ ‡æ³¨åŒºåŸŸ
3. è¿æ¥`ğŸ¯ Kontext Super Prompt`èŠ‚ç‚¹ç”Ÿæˆç¼–è¾‘æŒ‡ä»¤
4. å¯é€‰è¿æ¥AIå¢å¼ºèŠ‚ç‚¹è¿›ä¸€æ­¥ä¼˜åŒ–æç¤ºè¯

### èŠ‚ç‚¹è¿æ¥
- **LRPG Canvas**: è¾“å‡º`image`å’Œ`layer_info`
- **Kontext Super Prompt**: æ¥æ”¶`layer_info`å’Œ`image`ï¼Œè¾“å‡º`edited_image`å’Œ`generated_prompt`
- **AIå¢å¼ºå™¨**: æ¥æ”¶`layer_info`å›¾å±‚ä¿¡æ¯ï¼Œè¾“å‡ºAIä¼˜åŒ–çš„ç¼–è¾‘æŒ‡ä»¤

## ğŸ› ï¸ å®‰è£…

### æ–¹å¼ä¸€ï¼šGitå…‹éš†å®‰è£…
```bash
cd ComfyUI/custom_nodes
git clone https://github.com/aiaiaikkk/kontext-super-prompt.git
pip install torch torchvision opencv-python openai
```

### æ–¹å¼äºŒï¼šComfyUI Managerå®‰è£…
1. æ‰“å¼€ComfyUI Manager
2. æœç´¢"kontext-super-prompt"
3. ç‚¹å‡»å®‰è£…å¹¶é‡å¯ComfyUI

### å®‰è£…å®Œæˆ
é‡å¯ComfyUIåï¼Œåœ¨èŠ‚ç‚¹èœå•ä¸­æ‰¾åˆ°"ğŸ¨ LRPG Canvas"åˆ†ç±»

## âš¡ æ ¸å¿ƒç‰¹æ€§

- **ä¸“ä¸šç”»å¸ƒ**: åŸºäºFabric.jsçš„é«˜æ€§èƒ½å›¾å±‚ç¼–è¾‘å™¨
- **æ™ºèƒ½æ¨¡æ¿**: 40+ç§ä¸“ä¸šç¼–è¾‘æ“ä½œæ¨¡æ¿
- **å¤šAIé›†æˆ**: æ”¯æŒAPIå’Œæœ¬åœ°æ¨¡å‹å¢å¼º
- **æ¨¡å—åŒ–è®¾è®¡**: èŠ‚ç‚¹å¯ç‹¬ç«‹ä½¿ç”¨æˆ–ç»„åˆä½¿ç”¨
- **å®æ—¶åŒæ­¥**: ç”»å¸ƒçŠ¶æ€ä¸èŠ‚ç‚¹æ•°æ®å®æ—¶åŒæ­¥

---

**ç‰ˆæœ¬**: 1.3.2 | **è®¸å¯**: MIT | **ä»“åº“**: https://github.com/aiaiaikkk/kontext-super-prompt

---

# Kontext Super Prompt

**ComfyUI Image Editing & Intelligent Prompt Generation Toolkit** - Professional visual editing with AI-enhanced prompt generation

![Installation](images/instruction.png)

## ğŸ¯ Main Nodes

### ğŸ¨ LRPG Canvas  
Visual canvas annotation tool providing professional layer management and drawing capabilities
- Interactive canvas interface based on Fabric.js
- Support for multiple drawing tools and layer operations
- Automatically generates structured layer data for downstream nodes
- Real-time canvas state synchronization

![LRPG Canvas](images/LRPG_Canvas.png)

### ğŸ¯ Kontext Super Prompt
Intelligent prompt generator that converts layer information into structured editing instructions
- **Four editing modes**: Local editing, global editing, text editing, professional operations
- **40+ operation templates**: Including color transformation, style reconstruction, intelligent replacement, etc.
- **Constraints and enhancements**: Automatically generates quality control and effect enhancement prompts
- **Deterministic output**: Same input guarantees same results

![Kontext Super Prompt](images/KontextSuperPrompt.png)

## ğŸ¤– AI Enhancement Nodes

### API Flux Kontext Enhancer
Enhances prompt generation through API calls to multiple large language models
- **Supported platforms**: OpenAI, DeepSeek, Qianwen, Gemini, SiliconFlow
- **Cost control**: Real-time display of token consumption and cost estimation
- **Intelligent analysis**: Automatically understands editing intent and optimizes instructions

![API](images/api.png)

### Ollama Flux Kontext Enhancer  
Local-running large language model enhancer
- **Privacy protection**: Completely local processing, no network connection required
- **Model management**: Support for various open-source LLM models
- **Adjustable parameters**: Customizable temperature, max tokens, and other parameters

![Ollama](images/ollama.png)

### TextGenWebUI Flux Kontext Enhancer
Integration solution with Text Generation WebUI
- **Seamless integration**: Direct WebUI interface calls
- **Batch processing**: Support for multi-task parallel processing
- **Status monitoring**: Real-time display of processing progress

![TextGenWebUI](images/textgen_webui.png)

## ğŸ“‹ Usage

### Basic Workflow
1. Add `ğŸ¨ LRPG Canvas` node and connect image input
2. Create layers and annotation areas in the canvas
3. Connect `ğŸ¯ Kontext Super Prompt` node to generate editing instructions
4. Optionally connect AI enhancement nodes for further prompt optimization

### Node Connections
- **LRPG Canvas**: Outputs `image` and `layer_info`
- **Kontext Super Prompt**: Receives `layer_info` and `image`, outputs `edited_image` and `generated_prompt`
- **AI Enhancers**: Receive `layer_info` layer information, output AI-optimized editing instructions

## ğŸ› ï¸ Installation

### Method 1: Git Clone Installation
```bash
cd ComfyUI/custom_nodes
git clone https://github.com/aiaiaikkk/kontext-super-prompt.git
pip install torch torchvision opencv-python openai
```

### Method 2: ComfyUI Manager Installation
1. Open ComfyUI Manager
2. Search for "kontext-super-prompt"
3. Click install and restart ComfyUI

### Installation Complete
After restarting ComfyUI, find the "ğŸ¨ LRPG Canvas" category in the node menu

## âš¡ Core Features

- **Professional Canvas**: High-performance layer editor based on Fabric.js
- **Intelligent Templates**: 40+ professional editing operation templates
- **Multi-AI Integration**: Support for API and local model enhancement
- **Modular Design**: Nodes can be used independently or in combination
- **Real-time Sync**: Canvas state synchronizes with node data in real-time

---

**Version**: 1.3.2 | **License**: MIT | **Repository**: https://github.com/aiaiaikkk/kontext-super-prompt