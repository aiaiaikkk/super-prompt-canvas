<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”®ç›˜å¿«æ·é”®æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .shortcuts-info {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .shortcuts-info h2 {
            margin: 0 0 15px 0;
            color: #4CAF50;
        }
        .shortcut-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 10px;
        }
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #444;
        }
        .shortcut-key {
            background: #333;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .test-instructions {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .test-instructions h3 {
            margin: 0 0 10px 0;
            color: #ff9800;
        }
        .test-steps {
            list-style: none;
            padding: 0;
        }
        .test-steps li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
        }
        .test-steps li::before {
            content: counter(step-counter);
            counter-increment: step-counter;
            position: absolute;
            left: 0;
            background: #007bff;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        .test-steps {
            counter-reset: step-counter;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #4CAF50; }
        .status-warning { background: #ff9800; }
        .status-info { background: #2196F3; }
        
        .mock-canvas {
            width: 600px;
            height: 400px;
            border: 2px solid #444;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-size: 14px;
            margin: 20px 0;
            user-select: none;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .test-result {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }
        
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .warning { border-left: 4px solid #ff9800; }
        
        button {
            background: #007bff;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="shortcuts-info">
            <h2>ğŸ¹ é”®ç›˜å¿«æ·é”®åŠŸèƒ½åˆ—è¡¨</h2>
            <div class="shortcut-list">
                <div class="shortcut-item">
                    <span><span class="status-indicator status-success"></span>åˆ é™¤é€‰ä¸­å›¾å±‚</span>
                    <span class="shortcut-key">Delete / Backspace</span>
                </div>
                <div class="shortcut-item">
                    <span><span class="status-indicator status-success"></span>å…¨é€‰æ‰€æœ‰å›¾å±‚</span>
                    <span class="shortcut-key">Ctrl + A</span>
                </div>
                <div class="shortcut-item">
                    <span><span class="status-indicator status-success"></span>å–æ¶ˆé€‰æ‹©</span>
                    <span class="shortcut-key">Ctrl + D</span>
                </div>
                <div class="shortcut-item">
                    <span><span class="status-indicator status-info"></span>æ»šè½®ç¼©æ”¾å¯¹è±¡</span>
                    <span class="shortcut-key">é¼ æ ‡æ»šè½®</span>
                </div>
                <div class="shortcut-item">
                    <span><span class="status-indicator status-warning"></span>å¤åˆ¶ç²˜è´´ï¼ˆé¢„ç•™ï¼‰</span>
                    <span class="shortcut-key">Ctrl + C/V</span>
                </div>
                <div class="shortcut-item">
                    <span><span class="status-indicator status-warning"></span>æ’¤é”€é‡åšï¼ˆé¢„ç•™ï¼‰</span>
                    <span class="shortcut-key">Ctrl + Z/Y</span>
                </div>
            </div>
        </div>

        <div class="test-instructions">
            <h3>ğŸ§ª æµ‹è¯•è¯´æ˜</h3>
            <p>ä»¥ä¸‹æ˜¯é”®ç›˜å¿«æ·é”®çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹å’Œæµ‹è¯•æ­¥éª¤ï¼š</p>
            <ol class="test-steps">
                <li><strong>æ™ºèƒ½ä¸Šä¸‹æ–‡æ£€æµ‹</strong>ï¼šå¿«æ·é”®åªåœ¨ç”»å¸ƒæœ‰ç„¦ç‚¹æ—¶ç”Ÿæ•ˆï¼Œåœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ—¶ä¸ä¼šè¯¯è§¦å‘</li>
                <li><strong>å¤šé€‰æ”¯æŒ</strong>ï¼šDeleteé”®æ”¯æŒåˆ é™¤å•ä¸ªå¯¹è±¡å’Œå¤šé€‰å¯¹è±¡</li>
                <li><strong>é˜²å†²çªè®¾è®¡</strong>ï¼šåœ¨è¾“å…¥æ–‡æœ¬æ—¶ï¼ˆINPUTã€TEXTAREAç­‰ï¼‰è‡ªåŠ¨ç¦ç”¨åˆ é™¤é”®</li>
                <li><strong>å³æ—¶åé¦ˆ</strong>ï¼šåˆ é™¤æ“ä½œä¼šç«‹å³æ›´æ–°å›¾å±‚åˆ—è¡¨å’Œç”»å¸ƒæ˜¾ç¤º</li>
                <li><strong>æ§åˆ¶å°æ—¥å¿—</strong>ï¼šæ¯æ¬¡æ“ä½œéƒ½ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºç¡®è®¤ä¿¡æ¯</li>
            </ol>
        </div>

        <div class="mock-canvas" onclick="showTestResult()">
            ç‚¹å‡»è¿™é‡Œæ¨¡æ‹Ÿæµ‹è¯•ç”»å¸ƒç„¦ç‚¹<br>
            <small>ï¼ˆå®é™…ä½¿ç”¨æ—¶ï¼Œé”®ç›˜å¿«æ·é”®åœ¨çœŸå®çš„Fabric.jsç”»å¸ƒä¸Šç”Ÿæ•ˆï¼‰</small>
        </div>

        <div class="test-controls">
            <button onclick="simulateDelete()">æ¨¡æ‹ŸDeleteé”®</button>
            <button onclick="simulateSelectAll()">æ¨¡æ‹ŸCtrl+A</button>
            <button onclick="simulateDeselect()">æ¨¡æ‹ŸCtrl+D</button>
            <button onclick="checkImplementation()">æ£€æŸ¥å®ç°</button>
        </div>

        <div id="test-result" class="test-result">
            <h4>æµ‹è¯•ç»“æœ</h4>
            <div id="result-content"></div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿæµ‹è¯•åŠŸèƒ½
        function showTestResult() {
            const resultDiv = document.getElementById('test-result');
            const resultContent = document.getElementById('result-content');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result info';
            resultContent.innerHTML = `
                <p><strong>âœ… ç”»å¸ƒç„¦ç‚¹æµ‹è¯•</strong></p>
                <p>åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œé”®ç›˜å¿«æ·é”®çš„å·¥ä½œæµç¨‹ï¼š</p>
                <ol>
                    <li>ç”¨æˆ·ç‚¹å‡»ç”»å¸ƒåŒºåŸŸè·å¾—ç„¦ç‚¹</li>
                    <li>ç³»ç»Ÿæ£€æµ‹å½“å‰ç„¦ç‚¹å…ƒç´ æ˜¯å¦ä¸ºç”»å¸ƒæˆ–ç›¸å…³å®¹å™¨</li>
                    <li>å¦‚æœç„¦ç‚¹æ­£ç¡®ä¸”ä¸åœ¨è¾“å…¥çŠ¶æ€ï¼Œå“åº”é”®ç›˜äº‹ä»¶</li>
                    <li>æ‰§è¡Œç›¸åº”æ“ä½œå¹¶æ›´æ–°ç•Œé¢</li>
                </ol>
            `;
        }
        
        function simulateDelete() {
            const resultDiv = document.getElementById('test-result');
            const resultContent = document.getElementById('result-content');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultContent.innerHTML = `
                <p><strong>ğŸ—‘ï¸ Deleteé”®åŠŸèƒ½æ¨¡æ‹Ÿ</strong></p>
                <p><strong>é¢„æœŸè¡Œä¸ºï¼š</strong></p>
                <ul>
                    <li>æ£€æµ‹å½“å‰é€‰ä¸­çš„Fabric.jså¯¹è±¡</li>
                    <li>å¦‚æœæ˜¯å•ä¸ªå¯¹è±¡ï¼šç›´æ¥åˆ é™¤</li>
                    <li>å¦‚æœæ˜¯å¤šé€‰ï¼ˆActiveSelectionï¼‰ï¼šéå†åˆ é™¤æ‰€æœ‰å¯¹è±¡</li>
                    <li>æ›´æ–°ç”»å¸ƒæ¸²æŸ“å’Œå›¾å±‚åˆ—è¡¨</li>
                    <li>è¾“å‡ºæ§åˆ¶å°æ—¥å¿—: "[Canvas] å·²åˆ é™¤é€‰ä¸­çš„å›¾å±‚"</li>
                </ul>
                <p><strong>å®‰å…¨æœºåˆ¶ï¼š</strong>åªåœ¨éè¾“å…¥çŠ¶æ€ä¸‹ç”Ÿæ•ˆï¼Œé˜²æ­¢è¯¯åˆ é™¤ã€‚</p>
            `;
        }
        
        function simulateSelectAll() {
            const resultDiv = document.getElementById('test-result');
            const resultContent = document.getElementById('result-content');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultContent.innerHTML = `
                <p><strong>ğŸ¯ Ctrl+Aå…¨é€‰åŠŸèƒ½æ¨¡æ‹Ÿ</strong></p>
                <p><strong>é¢„æœŸè¡Œä¸ºï¼š</strong></p>
                <ul>
                    <li>è·å–ç”»å¸ƒä¸Šçš„æ‰€æœ‰å¯¹è±¡</li>
                    <li>åˆ›å»ºActiveSelectionå¤šé€‰å¯¹è±¡</li>
                    <li>è®¾ç½®ä¸ºå½“å‰æ´»åŠ¨é€‰æ‹©</li>
                    <li>æ‰€æœ‰å¯¹è±¡æ˜¾ç¤ºé€‰ä¸­çŠ¶æ€</li>
                </ul>
                <p><strong>åº”ç”¨åœºæ™¯ï¼š</strong>æ‰¹é‡æ“ä½œã€æ•´ä½“ç§»åŠ¨ã€ç»Ÿä¸€åˆ é™¤ç­‰ã€‚</p>
            `;
        }
        
        function simulateDeselect() {
            const resultDiv = document.getElementById('test-result');
            const resultContent = document.getElementById('result-content');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultContent.innerHTML = `
                <p><strong>âŒ Ctrl+Då–æ¶ˆé€‰æ‹©åŠŸèƒ½æ¨¡æ‹Ÿ</strong></p>
                <p><strong>é¢„æœŸè¡Œä¸ºï¼š</strong></p>
                <ul>
                    <li>è°ƒç”¨canvas.discardActiveObject()</li>
                    <li>æ¸…é™¤æ‰€æœ‰å¯¹è±¡çš„é€‰ä¸­çŠ¶æ€</li>
                    <li>éšè—é€‰æ‹©æ¡†å’Œæ§åˆ¶æ‰‹æŸ„</li>
                    <li>é‡æ–°æ¸²æŸ“ç”»å¸ƒ</li>
                </ul>
                <p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong>å¿«é€Ÿæ¸…é™¤é€‰æ‹©çŠ¶æ€ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ­¥æ“ä½œã€‚</p>
            `;
        }
        
        function checkImplementation() {
            const resultDiv = document.getElementById('test-result');
            const resultContent = document.getElementById('result-content');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result warning';
            resultContent.innerHTML = `
                <p><strong>ğŸ”§ å®ç°æ£€æŸ¥</strong></p>
                <p><strong>å…³é”®ä»£ç ä½ç½®ï¼š</strong></p>
                <ul>
                    <li><code>KontextCanvasNode.js:828</code> - setupKeyboardListenersæ–¹æ³•</li>
                    <li><code>KontextCanvasNode.js:854</code> - Delete/Backspaceå¤„ç†</li>
                    <li><code>KontextCanvasNode.js:880</code> - Ctrl+Aå¤„ç†</li>
                    <li><code>KontextCanvasNode.js:895</code> - Ctrl+Då¤„ç†</li>
                    <li><code>KontextCanvasNode.js:3255</code> - æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</li>
                </ul>
                <p><strong>æµ‹è¯•æ–¹æ³•ï¼š</strong></p>
                <ol>
                    <li>åœ¨ComfyUIä¸­æ‰“å¼€Super Prompt CanvasèŠ‚ç‚¹</li>
                    <li>ä¸Šä¼ å‡ å¼ å›¾ç‰‡åˆ°ç”»å¸ƒ</li>
                    <li>é€‰ä¸­å›¾ç‰‡åæŒ‰Deleteé”®æµ‹è¯•åˆ é™¤</li>
                    <li>ä½¿ç”¨Ctrl+Aæµ‹è¯•å…¨é€‰</li>
                    <li>ä½¿ç”¨Ctrl+Dæµ‹è¯•å–æ¶ˆé€‰æ‹©</li>
                    <li>æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—ç¡®è®¤åŠŸèƒ½æ‰§è¡Œ</li>
                </ol>
            `;
        }
        
        // é¡µé¢åŠ è½½æ—¶çš„æç¤º
        window.addEventListener('load', () => {
            console.log('ğŸ¹ é”®ç›˜å¿«æ·é”®æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('å®é™…åŠŸèƒ½éœ€è¦åœ¨ComfyUIçš„Super Prompt CanvasèŠ‚ç‚¹ä¸­æµ‹è¯•');
        });
    </script>
</body>
</html>